# GameForge Mobile - Replit Configuration
# This file configures the Replit environment for running and deploying the app

# Main entry and language settings
entrypoint = "index.js"
modules = ["nodejs-20:v8-20230920-bd784b9"]

# Hidden files (won't show in file browser)
hidden = [".config", "package-lock.json"]

[nix]
channel = "stable-24_05"

# Development run command
[run]
command = "npm run web"

# Deployment configuration for Expo web
[deployment]
run = ["sh", "-c", "npm run web"]
deploymentTarget = "cloudrun"
build = ["sh", "-c", "npm install && npm run build:web"]
publicDir = "web-build"

# Environment variables
[env]
EXPO_USE_METRO_WORKSPACE_ROOT = "true"
CI = "false"

# Language support
[languages]

[languages.typescript]
pattern = "**/{*.ts,*.tsx}"

[languages.typescript.languageServer]
start = "typescript-language-server --stdio"

[languages.javascript]
pattern = "**/{*.js,*.jsx}"

[languages.javascript.languageServer]
start = "typescript-language-server --stdio"

# Ports configuration for Expo
[[ports]]
localPort = 8081
externalPort = 80

[[ports]]
localPort = 19000
externalPort = 3000

[[ports]]
localPort = 19001
externalPort = 3001

[[ports]]
localPort = 19002
externalPort = 3002

# Workflow for installing dependencies
[workflows]

[workflows.install]
name = "Install Dependencies"
mode = "parallel"
author = "replit"

[[workflows.install.tasks]]
task = "shell.exec"
args = "npm install"

# Workflow for running tests
[workflows.test]
name = "Run Tests"
mode = "sequential"
author = "replit"

[[workflows.test.tasks]]
task = "shell.exec"
args = "npm test"

# Workflow for linting
[workflows.lint]
name = "Lint Code"
mode = "sequential"
author = "replit"

[[workflows.lint.tasks]]
task = "shell.exec"
args = "npm run lint"

# Workflow for building
[workflows.build]
name = "Build for Web"
mode = "sequential"
author = "replit"

[[workflows.build.tasks]]
task = "shell.exec"
args = "npm run build:web"